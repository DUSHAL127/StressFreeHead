<div class="forgot-password-wrapper">
  <div class="forgot-password-container">
    <!-- Logo Section -->
    <div class="logo-container">
      <img src="assets/logo.jpeg" alt="Company Logo" class="logo-avatar">
    </div>
    
    <!-- Reset Password Form -->
    <div *ngIf="!otpRequested && !passwordReset">
      <h2>Forgot Password?</h2>
      <p class="forgot-password-message">Don’t worry, we’ll help you reset it. Please enter your email address.</p>
      <form [formGroup]="resetPasswordForm" (ngSubmit)="requestOtp()">
        <mat-form-field appearance="fill" class="full-width">
          <mat-label>Email address</mat-label>
          <input matInput type="email" formControlName="email" placeholder="Enter your email">
          <mat-error *ngIf="resetPasswordForm.get('email')?.hasError('required')">
            Email is required
          </mat-error>
          <mat-error *ngIf="resetPasswordForm.get('email')?.hasError('email')">
            Please enter a valid email address
          </mat-error>
        </mat-form-field>
        <button mat-raised-button color="primary" class="full-width reset-button" type="submit" [disabled]="resetPasswordForm.invalid">
          Reset Password
        </button>
      </form>
      <p class="login-redirect">Remember your password? <a routerLink="/login" class="login-link">Login here</a>.</p>
    </div>
    
    <!-- OTP Form -->
    <div *ngIf="otpRequested && !passwordReset">
      <h2>Enter OTP</h2>
      <p class="forgot-password-message">We have sent you an OTP. Please enter it below to proceed.</p>
      <form [formGroup]="otpForm" (ngSubmit)="verifyOtp()">
        <mat-form-field appearance="fill" class="full-width">
          <mat-label>OTP</mat-label>
          <input matInput type="text" formControlName="otp" placeholder="Enter your OTP">
          <mat-error *ngIf="otpForm.get('otp')?.hasError('required')">
            OTP is required
          </mat-error>
        </mat-form-field>
        <button mat-raised-button color="primary" class="full-width reset-button" type="submit" [disabled]="otpForm.invalid">
          Verify OTP
        </button>
      </form>
    </div>

    <!-- Password Reset Form -->
    <div *ngIf="passwordReset">
      <h2>Reset Your Password</h2>
      <p class="forgot-password-message">Please enter your new password and confirm it below.</p>
      <form [formGroup]="passwordResetForm" (ngSubmit)="resetPassword()">
        <mat-form-field appearance="fill" class="full-width">
          <mat-label>New Password</mat-label>
          <input matInput type="password" formControlName="newPassword" placeholder="Enter new password">
          <mat-error *ngIf="passwordResetForm.get('newPassword')?.hasError('required')">
            New Password is required
          </mat-error>
          <mat-error *ngIf="passwordResetForm.get('newPassword')?.hasError('minlength')">
            Password must be at least 6 characters long
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill" class="full-width">
          <mat-label>Confirm Password</mat-label>
          <input matInput type="password" formControlName="confirmPassword" placeholder="Confirm your password">
          <mat-error *ngIf="passwordResetForm.get('confirmPassword')?.hasError('required')">
            Confirm Password is required
          </mat-error>
          <mat-error *ngIf="passwordResetForm.hasError('passwordMismatch')">
            Passwords do not match
          </mat-error>
        </mat-form-field>
        
        <button mat-raised-button color="primary" class="full-width reset-button" type="submit" [disabled]="passwordResetForm.invalid">
          Change Password
        </button>
      </form>
    </div>
  </div>
</div>

<!-- Modal Component -->
<app-modal *ngIf="showModal"
           [title]="modalTitle"
           [message]="modalMessage"
           (close)="onModalClose()">
</app-modal>
